<div class="progress-container m-1 px-1 py-1 shadow rounded">
  <!-- Erstes Drittel: Punktzahl des aktuellen Spielers -->
  <div class="section player-info">
    <mat-card class="matcardpointer info-card h-100"
              (click)="currentPlayerService.showHistory(currentPlayerService._currentPlayer.value)">
      <div class="player-name text-truncate">
        {{ currentPlayerService._currentPlayer.value.name || 'Spieler' }}
      </div>
      <div class="player-score">{{ this.currentPlayerService._remainingPointsToDisplay() }}</div>
      <div class="player-avg small">⌀ {{ currentPlayerService._currentPlayer.value.average }}</div>
      <div class="last-hits mt-1">
        <span *ngFor="let hit of currentPlayerService._last3History" class="hit-badge badge bg-secondary me-1">
          {{ hit }}
        </span>
      </div>
    </mat-card>
  </div>

  <!-- Zweites Drittel: Drei Pfeil-Buttons vertikal und Rundeninfo rechts daneben -->
  <div class="section dart-status">
    <div class="status-content">
      <div class="dart-buttons-vertical">
        <button
          [color]="(currentPlayerService._remainingThrows >= 1) ? getProgressColor() : 'gray'"
          mat-mini-fab
          class="no-pointer"
        ><span>➶</span>
        </button>
        <button
          [color]="(currentPlayerService._remainingThrows >= 2) ? getProgressColor() : 'gray'"
          mat-mini-fab
          class="no-pointer"
        ><span>➶</span>
        </button>
        <button
          [color]="(currentPlayerService._remainingThrows >= 3) ? getProgressColor() : 'gray'"
          mat-mini-fab
          class="no-pointer"
        ><span>➶</span>
        </button>
      </div>
      <div class="round-info small text-nowrap">
        <span class="round-label">Runde</span>
        <span class="round-value">{{ roundCountService.roundCount }}/{{ roundCountService.MAX_ROUND_COUNT }}</span>
        <button class="p-2" mat-icon-button (click)="openPlayersOverviewDialog()">
          <mat-icon>groups</mat-icon>
        </button>
      </div>
    </div>
  </div>

  <!-- Drittes Drittel: Übersicht aller Spieler -->
  <div class="section players-overview">
    <div class="mini-scoreboard">
      <ng-container *ngFor="let player of playerService._players">
        <div class="mini-player-row" [class.active-player]="player.id === currentPlayerService._currentPlayer.value.id">
          <div class="mini-player-main-info">
            <div class="mini-player-name">{{ player.name }}</div>
            @if ((currentPlayerService._currentPlayer.value !== player &&
              currentPlayerService._currentPlayer.value.remainingPoints < player.remainingPoints
              && currentPlayerService.currentGameMode === GameType.Elimination301)) {
              <div
                class="diff-score small ms-1">
                ({{ getDiffToCurrentPlayer(player) }})
              </div>
            }
          </div>

          <div class="mini-player-actions d-flex align-items-center">
            <!-- Cricket Miniature -->
            <div *ngIf="currentPlayerService.currentGameMode === GameType.Cricket"
                 class="cricket-mini-display d-flex me-2">
              <div *ngFor="let val of getCricketValues()"
                   class="cricket-circle-wrapper">
                <div class="cricket-circle"
                     [class.closed]="getCricketHitCount(player, val) >= 3"
                     [attr.title]="val === 25 ? 'Bull' : val">
                  <span class="cricket-value">{{ val === 25 ? 'B' : val }}</span>
                </div>
                <div class="hit-count" [class.closed]="getCricketHitCount(player, val) >= 3">
                  {{ getCricketHitCount(player, val) }}
                </div>
              </div>
            </div>

            <span class="mini-player-score fw-bold matcardpointer"
                  (click)="currentPlayerService.showHistory(player)">
            {{ player.remainingPoints }}
          </span>
          </div>
        </div>
      </ng-container>
    </div>
  </div>
</div>

